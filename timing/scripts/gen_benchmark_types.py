#!/usr/bin/env python3

import argparse
import re

HEADER = \
"""
/**
 * This file is **autogenerated** by Python. Any manual changes to it will be
 * OVERWRITTEN!
 */

"""

LINE_FORMAT = "#define {0}{2},"

if __name__ == '__main__':
    # Read arguments
    parser = argparse.ArgumentParser()

    parser.add_argument("--src_file", help="Source file to parse", required=True)
    parser.add_argument("--tar_file", help="Target file to write parsed enum to",
                        required=True)
    parser.add_argument("--pattern", help="Pattern of elements to match",
                        default=r"BENCH_TYPE_[A-Z]+")

    args = parser.parse_args()

    src_file    = args.src_file
    tar_file    = args.tar_file
    pattern     = args.pattern


    matches = []
    with open(src_file, "r") as src_fp:
        regex   = re.compile(pattern)
        matches = regex.findall(src_fp.readlines())

    line_len = max([len(match) for match in matches]) + 1

    with open(tar_file, "w+") as tar_fp:
        for idx, match in enumerate(matches):
            tar_fp.writeline(LINE_FORMAT.format(match.ljust(line_len), idx))
